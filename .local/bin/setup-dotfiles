#/usr/bin bash                                                             
                                                                           
git clone --bare git@github.com:dickolsson/dotfiles.git $HOME/.dotfiles    
                                                                           
function dotfiles {                                                        
  /usr/bin/git --git-dir=$HOME/.dotfiles --work-tree=$HOME $@              
}                                                                          
                                                                           
dotfiles checkout                                                          
                                                                           
# Backup files if checkout was not successful.                             
if [ $? = 1 ]; then                                                        
  dotfiles checkout 2>&1 \                                                 
    egrep "\t?\." | \                                                      
    awk {'print $1'} | \                                                   
    xargs -I{} rsync -q -a -R {} $HOME/.dotfiles-backup/ 2>/dev/null       
fi                                                                         
                                                                           
dotfiles checkout                                                          
dotfiles config status.showUntrackedFiles no
